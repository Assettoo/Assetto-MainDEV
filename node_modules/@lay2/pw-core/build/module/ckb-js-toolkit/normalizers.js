// This package provides normalizer functions. Even though CKB uses molecule
// as the serialization layer. There is still CKB specific knowledge that does
// not belong in molecule. For example, all numbers in CKB protocols are
// serialized using little endian format. This package tries to encode such
// knowledge. The goal here, is that you are free to use whatever types that
// makes most sense to represent the values. As long as you pass your object
// through the normalizers here, molecule should be able to serialize the values
// into correct formats required by CKB.
//
// Note this is only used when you need to deal with CKB structures in molecule
// format. If you are using RPCs or GraphQL to interact with CKB, chances are you
// will not need this package.
import JSBI from 'jsbi';
import { Reader } from './reader';
import { BigIntToHexString } from './rpc';
function normalizeHexNumber(length) {
    return function (debugPath, value) {
        if (!(value instanceof ArrayBuffer)) {
            let intValue = BigIntToHexString(JSBI.BigInt(value)).substr(2);
            if (intValue.length % 2 !== 0) {
                intValue = '0' + intValue;
            }
            if (intValue.length / 2 > length) {
                throw new Error(`${debugPath} is ${intValue.length / 2} bytes long, expected length is ${length}!`);
            }
            const view = new DataView(new ArrayBuffer(length));
            for (let i = 0; i < intValue.length / 2; i++) {
                const start = intValue.length - (i + 1) * 2;
                view.setUint8(i, parseInt(intValue.substr(start, 2), 16));
            }
            value = view.buffer;
        }
        if (value.byteLength < length) {
            const array = new Uint8Array(length);
            array.set(new Uint8Array(value), 0);
            value = array.buffer;
        }
        return value;
    };
}
function normalizeRawData(length) {
    return function (debugPath, value) {
        value = new Reader(value).toArrayBuffer();
        if (length > 0 && value.byteLength !== length) {
            throw new Error(`${debugPath} has invalid length ${value.byteLength}, required: ${length}`);
        }
        return value;
    };
}
function normalizeObject(debugPath, object, keys) {
    const result = {};
    for (const [key, f] of Object.entries(keys)) {
        const value = object[key];
        if (!value) {
            throw new Error(`${debugPath} is missing ${key}!`);
        }
        result[key] = f(`${debugPath}.${key}`, value);
    }
    return result;
}
export function NormalizeScript(script, { debugPath = 'script' } = {}) {
    return normalizeObject(debugPath, script, {
        code_hash: normalizeRawData(32),
        hash_type: function (debugPath, value) {
            switch (value) {
                case 'data':
                    return 0;
                case 'type':
                    return 1;
                case 0:
                    return value;
                case 1:
                    return value;
                default:
                    throw new Error(`${debugPath}.hash_type has invalid value: ${value}`);
            }
        },
        args: normalizeRawData(-1),
    });
}
export function NormalizeOutPoint(outPoint, { debugPath = 'out_point' } = {}) {
    return normalizeObject(debugPath, outPoint, {
        tx_hash: normalizeRawData(32),
        index: normalizeHexNumber(4),
    });
}
function toNormalize(normalize) {
    return function (debugPath, value) {
        return normalize(value, {
            debugPath,
        });
    };
}
export function NormalizeCellInput(cellInput, { debugPath = 'cell_input' } = {}) {
    return normalizeObject(debugPath, cellInput, {
        since: normalizeHexNumber(8),
        previous_output: toNormalize(NormalizeOutPoint),
    });
}
export function NormalizeCellOutput(cellOutput, { debugPath = 'cell_output' } = {}) {
    const result = normalizeObject(debugPath, cellOutput, {
        capacity: normalizeHexNumber(8),
        lock: toNormalize(NormalizeScript),
    });
    if (cellOutput.type) {
        result.type_ = NormalizeScript(cellOutput.type, {
            debugPath: `${debugPath}.type`,
        });
    }
    return result;
}
export function NormalizeCellDep(cellDep, { debugPath = 'cell_dep' } = {}) {
    return normalizeObject(debugPath, cellDep, {
        out_point: toNormalize(NormalizeOutPoint),
        dep_type: function (debugPath, value) {
            switch (value) {
                case 'code':
                    return 0;
                case 'dep_group':
                    return 1;
                case 0:
                    return value;
                case 1:
                    return value;
                default:
                    throw new Error(`${debugPath}.dep_type has invalid value: ${value}`);
            }
        },
    });
}
function toNormalizeArray(normalizeFunction) {
    return function (debugPath, array) {
        return array.map((item, i) => {
            return normalizeFunction(`${debugPath}[${i}]`, item);
        });
    };
}
export function NormalizeRawTransaction(rawTransaction, { debugPath = 'raw_transaction' } = {}) {
    return normalizeObject(debugPath, rawTransaction, {
        version: normalizeHexNumber(4),
        cell_deps: toNormalizeArray(toNormalize(NormalizeCellDep)),
        header_deps: toNormalizeArray(normalizeRawData(32)),
        inputs: toNormalizeArray(toNormalize(NormalizeCellInput)),
        outputs: toNormalizeArray(toNormalize(NormalizeCellOutput)),
        outputs_data: toNormalizeArray(normalizeRawData(-1)),
    });
}
export function NormalizeTransaction(transaction, { debugPath = 'transaction' } = {}) {
    const rawTransaction = NormalizeRawTransaction(transaction, {
        debugPath: `(raw)${debugPath}`,
    });
    const result = normalizeObject(debugPath, transaction, {
        witnesses: toNormalizeArray(normalizeRawData(-1)),
    });
    result.raw = rawTransaction;
    return result;
}
export function NormalizeRawHeader(rawHeader, { debugPath = 'raw_header' } = {}) {
    return normalizeObject(debugPath, rawHeader, {
        version: normalizeHexNumber(4),
        compact_target: normalizeHexNumber(4),
        timestamp: normalizeHexNumber(8),
        number: normalizeHexNumber(8),
        epoch: normalizeHexNumber(8),
        parent_hash: normalizeRawData(32),
        transactions_root: normalizeRawData(32),
        proposals_hash: normalizeRawData(32),
        uncles_hash: normalizeRawData(32),
        dao: normalizeRawData(32),
    });
}
export function NormalizeHeader(header, { debugPath = 'header' } = {}) {
    const rawHeader = NormalizeRawHeader(header, {
        debugPath: `(raw)${debugPath}`,
    });
    const result = normalizeObject(debugPath, header, {
        nonce: normalizeHexNumber(16),
    });
    result.raw = rawHeader;
    return result;
}
export function NormalizeUncleBlock(uncleBlock, { debugPath = 'uncle_block' } = {}) {
    return normalizeObject(debugPath, uncleBlock, {
        header: toNormalize(NormalizeHeader),
        proposals: toNormalizeArray(normalizeRawData(10)),
    });
}
export function NormalizeBlock(block, { debugPath = 'block' } = {}) {
    return normalizeObject(debugPath, block, {
        header: toNormalize(NormalizeHeader),
        uncles: toNormalizeArray(toNormalize(NormalizeUncleBlock)),
        transactions: toNormalizeArray(toNormalize(NormalizeTransaction)),
        proposals: toNormalizeArray(normalizeRawData(10)),
    });
}
export function NormalizeCellbaseWitness(cellbaseWitness, { debugPath = 'cellbase_witness' } = {}) {
    return normalizeObject(debugPath, cellbaseWitness, {
        lock: toNormalize(NormalizeScript),
        message: normalizeRawData(-1),
    });
}
export function NormalizeWitnessArgs(witnessArgs, { debugPath = 'witness_args' } = {}) {
    const result = {};
    if (witnessArgs.lock) {
        result.lock = normalizeRawData(-1)(`${debugPath}.lock`, witnessArgs.lock);
    }
    if (witnessArgs.input_type) {
        result.input_type = normalizeRawData(-1)(`${debugPath}.input_type`, witnessArgs.input_type);
    }
    if (witnessArgs.output_type) {
        result.output_type = normalizeRawData(-1)(`${debugPath}.output_type`, witnessArgs.output_type);
    }
    return result;
}
export const normalizers = {
    NormalizeScript,
    NormalizeOutPoint,
    NormalizeCellInput,
    NormalizeCellOutput,
    NormalizeCellDep,
    NormalizeRawTransaction,
    NormalizeTransaction,
    NormalizeRawHeader,
    NormalizeHeader,
    NormalizeUncleBlock,
    NormalizeBlock,
    NormalizeCellbaseWitness,
    NormalizeWitnessArgs,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9ybWFsaXplcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY2tiLWpzLXRvb2xraXQvbm9ybWFsaXplcnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsNEVBQTRFO0FBQzVFLDhFQUE4RTtBQUM5RSx3RUFBd0U7QUFDeEUsMkVBQTJFO0FBQzNFLDRFQUE0RTtBQUM1RSw0RUFBNEU7QUFDNUUsZ0ZBQWdGO0FBQ2hGLHdDQUF3QztBQUN4QyxFQUFFO0FBQ0YsK0VBQStFO0FBQy9FLGlGQUFpRjtBQUNqRiw4QkFBOEI7QUFDOUIsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDbEMsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sT0FBTyxDQUFDO0FBRTFDLFNBQVMsa0JBQWtCLENBQUMsTUFBTTtJQUNoQyxPQUFPLFVBQVUsU0FBUyxFQUFFLEtBQUs7UUFDL0IsSUFBSSxDQUFDLENBQUMsS0FBSyxZQUFZLFdBQVcsQ0FBQyxFQUFFO1lBQ25DLElBQUksUUFBUSxHQUFHLGlCQUFpQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0QsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQzdCLFFBQVEsR0FBRyxHQUFHLEdBQUcsUUFBUSxDQUFDO2FBQzNCO1lBQ0QsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsR0FBRyxNQUFNLEVBQUU7Z0JBQ2hDLE1BQU0sSUFBSSxLQUFLLENBQ2IsR0FBRyxTQUFTLE9BQ1YsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUNwQixtQ0FBbUMsTUFBTSxHQUFHLENBQzdDLENBQUM7YUFDSDtZQUNELE1BQU0sSUFBSSxHQUFHLElBQUksUUFBUSxDQUFDLElBQUksV0FBVyxDQUFDLE1B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